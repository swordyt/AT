package com.yinting.core.datadriver;

import java.io.File;
import java.io.IOException;
import java.lang.reflect.Method;

import javax.management.RuntimeErrorException;

import jxl.Sheet;
import jxl.Workbook;
import jxl.read.biff.BiffException;

public class ExcelDriver extends DataDriver {
	private int position = 0;
	private int total = 0;
	private String[] parameter;
	private String filePath = "";// excel 路径
	private String sheetName = "";
	private String[] rowName;
	private Workbook book = null;
	private Sheet sheet = null;

	public ExcelDriver(Method method) {
		parameter = DataDriver.parameteres.get(md5(method));
		total = parameter.length;
		filePath = parameter[0];// 第一个参数为filePath
		sheetName = parameter[1];// 第二个参数为sheetName
		readExcel(filePath, sheetName);
	}

	public boolean hasNext() {
		// TODO Auto-generated method stub
		return position < total;
		// return true;
	}

	public Object[] next() {

		return new Object[] { parameter[position++] };
	}

	@Override
	public int getType() {
		// TODO Auto-generated method stub
		return 0;
	}

	public void remove() {
		// TODO Auto-generated method stub

	}

	private void readLine() {

	}

	private void readRow() {

	}

	// 初始化
	private void readExcel(String path, String sheet) {
			try {
				this.book=Workbook.getWorkbook(new File(path));
			} catch (Exception e) {
				throw new RuntimeException(path+"文件未发现");
			}
	}

}
